## å‰è¨€

å‰è¾¹å­¦ä¹ äº†ï¼š

1. [ä»€ä¹ˆæ˜¯è¿›ç¨‹çº¿ç¨‹](https://github.com/FE-Huang/StudyNotes/blob/master/6.%20FE%E7%9B%B8%E5%85%B3%26%E5%BB%B6%E7%94%B3/%E6%B5%8F%E8%A7%88%E5%99%A8/Chrome%E7%9A%84%E8%BF%9B%E7%A8%8B%26%E7%BA%BF%E7%A8%8B.md)
2. [Chromeçš„è¿›ç¨‹&çº¿ç¨‹](https://github.com/FE-Huang/StudyNotes/blob/master/6.%20FE%E7%9B%B8%E5%85%B3%26%E5%BB%B6%E7%94%B3/%E6%B5%8F%E8%A7%88%E5%99%A8/%E9%A1%B5%E9%9D%A2%E6%B8%B2%E6%9F%93%E6%B5%81%E7%A8%8B(%E8%BF%9B%E7%A8%8B%26%E7%BA%BF%E7%A8%8B%E8%A7%92%E5%BA%A6).md)ï¼ˆä»¥è¯´æ³•1ä¸ºå‡†ï¼Œè¯´æ³•2ä»…ä¾›å‚è€ƒï¼‰:  
  ![Chromeçš„è¿›ç¨‹&çº¿ç¨‹](https://gitee.com/ahuang6027/blog-images/raw/master/images/process-and-threads-structure.png)
3. [ä»è¿›ç¨‹&çº¿ç¨‹çœ‹-é¡µé¢æ¸²æŸ“æµç¨‹](https://github.com/FE-Huang/StudyNotes/blob/master/6.%20FE%E7%9B%B8%E5%85%B3%26%E5%BB%B6%E7%94%B3/%E6%B5%8F%E8%A7%88%E5%99%A8/%E4%BB%8E%E8%BF%9B%E7%A8%8B%26%E7%BA%BF%E7%A8%8B%E7%9C%8B-%E9%A1%B5%E9%9D%A2%E6%B8%B2%E6%9F%93%E6%B5%81%E7%A8%8B.md):  
  ![è¿›ç¨‹&çº¿ç¨‹-æ¸²æŸ“](https://gitee.com/ahuang6027/blog-images/raw/master/images/process-parse-render-pipeline.png)

è¿™ç¯‡ç¬”è®°å…¶å®æ˜¯æŸ¥æ‰¾â€œé¡µé¢æ¸²æŸ“æµç¨‹â€èµ„æ–™çš„è¿‡ç¨‹ä¸­ï¼Œé˜…è¯»åˆ°çš„ä¸€ä¸ªè¢«æˆ‘å¿½ç•¥çš„ä¸œè¥¿ï¼Œå»ºè®®ä¼™ä¼´ä»¬åœ¨çœ‹å®Œå‰è¾¹çš„ç¬”è®°ï¼ˆæˆ–è€…çœ‹å®Œæˆ‘æ”¾çš„æˆªå›¾ï¼‰åå†çœ‹æœ¬ç¯‡~

å¦å¤–ç›¸ä¿¡ä¼™ä¼´ä»¬åœ¨ç ”ç©¶react fiberæ¶æ„æ—¶ï¼Œéƒ½ä¼šçœ‹åˆ°`requestAnimationFrame`å’Œ`requestIdleCallback`ï¼Œå®ƒä»¬éƒ½ä¸æµè§ˆå™¨çš„å¸§æ¯æ¯ç›¸å…³ã€‚

## å¸§å’ŒFPS

> å¦‚æœä¸äº†è§£Performanceï¼Œå¯ä»¥çœ‹[è¿™ç¯‡](https://developer.chrome.com/docs/devtools/evaluate-performance/?utm_source=devtools#get-started)å®˜æ–¹çš„æ–‡ç« ã€‚

åœ¨Chromeæµè§ˆå™¨ä¸­ï¼Œæ‰“å¼€devToolsï¼Œæœ‰ä¸€ä¸ªPerformanceæ ‡ç­¾ï¼Œå·¦ä¸Šè§’æœ‰ä¸€ä¸ªreloadçš„æŒ‰é’®ï¼Œç‚¹å®ƒå½•åˆ¶é¡µé¢åŠ è½½çš„è¿‡ç¨‹ï¼Œç­‰é¡µé¢åŠ è½½å®Œç‚¹åœæ­¢ï¼Œç„¶åæµè§ˆå™¨å°±ä¼šåˆ†æå¹¶æ˜¾ç¤ºæ€§èƒ½åˆ†ææŠ¥å‘Šï¼š

![FPSå’Œå¸§](https://gitee.com/ahuang6027/blog-images/raw/master/images/devtool-performance-frames-fps.png)

ä¸Šå›¾ä¸­é—´ä½ç½®æœ‰ä¸€è¡Œè¡¨ç¤ºå¸§ï¼Œå¯ä»¥ç‚¹å‡»æŸ¥çœ‹æ¯ä¸€å¸§çš„è¯¦æƒ…ã€‚è¿™é‡Œæˆ‘éšä¾¿ç‚¹äº†ä¸€ä¸ªï¼Œå¯ä»¥çœ‹åˆ°å®ƒæ€»æ—¶é•¿18.79æ¯«ç§’ï¼ŒFPSä¸º53ã€‚å¦å¤–ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œåœ¨é¡µé¢é¦–æ¬¡ç»˜åˆ¶(FP)ä¹‹å‰ï¼Œå¸§é‚£ä¸€è¡Œæ˜¯ç©ºçš„ã€‚

### ä»€ä¹ˆæ˜¯å¸§

> ã€â—æ³¨æ„ã€‘â€œä»€ä¹ˆæ˜¯å¸§â€è¿™ä¸€å°èŠ‚ï¼Œå¾ˆå¤šéƒ½æ˜¯æˆ‘è‡ªå·±çš„ç†è§£ï¼Œå¾ˆå¯èƒ½æœ‰è¯¯ï¼ˆå› ä¸ºæˆ‘æ²¡æ‰¾ç€å®˜æ–¹æ–‡æ¡£==ï¼‰ã€‚è·ªæ±‚å¤§ä½¬ä»¬æŒ‡æ­£ï¼
>
> è¿˜è®°å¾—å—ï¼Œåœ¨ç¬”è®°[ä»è¿›ç¨‹&çº¿ç¨‹çœ‹-é¡µé¢æ¸²æŸ“æµç¨‹](https://github.com/FE-Huang/StudyNotes/blob/master/6.%20FE%E7%9B%B8%E5%85%B3%26%E5%BB%B6%E7%94%B3/%E6%B5%8F%E8%A7%88%E5%99%A8/%E4%BB%8E%E8%BF%9B%E7%A8%8B%26%E7%BA%BF%E7%A8%8B%E7%9C%8B-%E9%A1%B5%E9%9D%A2%E6%B8%B2%E6%9F%93%E6%B5%81%E7%A8%8B.md)ä¸­ï¼š  
>
> - åˆæˆå¸§ï¼šåœ¨å›¾å±‚æ …æ ¼åŒ–åï¼Œåˆæˆçº¿ç¨‹ä¼šæ”¶é›†å›¾å—ä¸Šå«ç»˜ç”»å››è¾¹å½¢(draw quads)çš„ä¿¡æ¯æ„å»ºåˆæˆå¸§ï¼›
> - æ¸²æŸ“æµæ°´çº¿ï¼šæ˜¯æŒ‡æ¸²æŸ“è¿›ç¨‹ä»è§£æHTMLæ–‡ä»¶åˆ°åˆæˆé¡µé¢

**å¯¹å¸§è·Ÿåˆæˆå¸§çš„ç†è§£ï¼š**

- åˆæˆå¸§æ˜¯æ¸²æŸ“æµæ°´çº¿æœ€ååˆæˆåå¾—åˆ°çš„â€œç»“æœâ€ï¼›
- è¿™é‡Œè¯´çš„å¸§æ›´åƒæ˜¯ä¸€ä¸ªâ€œè¿‡ç¨‹â€ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå„ä¸ªçº¿ç¨‹äº’ç›¸é…åˆåä½œï¼Œä»äº‹ä»¶è§¦å‘åˆ°`requestIdleCallback`ï¼Œå…¶ä¸­åŒ…å«äº†åˆæˆå¸§è¿™ä¸ªç»“æœã€‚ï¼ˆè¿™ä¸ªè¿‡ç¨‹å†™åœ¨ä¸‹æ–‡ï¼‰

**å¦æœ‰ä¸€ä¸ªæˆ‘ä¸ç¡®å®šçš„ç‚¹ï¼š**

ä»ä¸Šè¾¹çš„Performanceåˆ†æå›¾ä¸­çœ‹åˆ°ï¼Œé¡µé¢é¦–æ¬¡ç»˜åˆ¶(FP)ä¹‹å‰ï¼Œå¸§é‚£ä¸€è¡Œæ˜¯ç©ºçš„ã€‚æ˜¯ä¸æ˜¯æ„å‘³ç€é¡µé¢åœ¨FPä¹‹å‰ï¼Œæ˜¯æ²¡æœ‰å¸§çš„å‘¢ï¼Ÿ  
è¿™æ˜¯æˆ‘è‡ªå·±çš„çœ‹æ³•ï¼ˆâ—å¾ˆå¯èƒ½æœ‰è¯¯ï¼‰ï¼š

- é¦–å…ˆæˆ‘è§‰å¾—å¯¹å¸§çš„ç†è§£ä¸Šï¼Œåˆ«å¤ªå±€é™è‡ªå·±ã€‚ä¸­æ–‡åšå¤§ç²¾æ·±ï¼Œå¬è€å¸ˆçš„è¯ï¼Œå’±ä¹Ÿç»“åˆè¯­å¢ƒæ¥ç†è§£å¸§è¿™ä¸ªå­—ã€‚å¦‚æœè¯´è¯­å¢ƒä¸Šå®ƒè¡¨ç¤ºä¸€ä¸ªè¿‡ç¨‹ï¼Œå°±æŠŠå®ƒç†è§£æˆè¿‡ç¨‹ï¼›å¦‚æœè¯´è¡¨ç¤ºè¦æ¸²æŸ“çš„ä¸œè¥¿ï¼ˆå³ç»“æœï¼‰ï¼Œé‚£å®ƒå°±æ˜¯åˆæˆå¸§ã€‚
- å…¶æ¬¡åœ¨performanceä¸­ï¼Œå¸§æ—¢æ˜¯ä¸€ä¸ªè¿‡ç¨‹ï¼Œå…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªç»“æœã€‚é¡µé¢FPä¹‹å‰ï¼Œæµè§ˆå™¨è¿ä¸€ä¸ªåˆæˆå¸§éƒ½æ²¡â€œé€ â€å‡ºæ¥ï¼Œæ‰€ä»¥æ€ä¹ˆå¯èƒ½æœ‰å¸§å‘¢ã€‚
- è¿˜æœ‰ä¸€ç§æƒ…å†µï¼ŒåŠ å…¥DOMæ„å»ºå®Œæ¯•ä½†cssè¿˜åœ¨ä¸‹è½½ï¼Œè¿™ç§æƒ…å†µä¸‹æ¸²æŸ“æµæ°´çº¿æ— äº‹å¯åšï¼Œå°±ä¹Ÿä¼šæœ‰ä¸€ä¸ªç©ºé—²æ—¶é—´ã€‚

### ä»€ä¹ˆæ˜¯FPS

> ã€â—æ³¨æ„ã€‘è®¾å¤‡çš„å±å¹•åˆ·æ–°ç‡å’Œæµè§ˆå™¨çš„FPSæ˜¯ä¸¤ä¸ªæ¦‚å¿µã€‚å±å¹•åˆ·æ–°ç‡æ˜¯æˆ‘ä»¬çš„ç”µè„‘å±å¹•æ¯ç§’èƒ½å¤Ÿæ˜¾ç¤ºå›¾åƒçš„æ¬¡æ•°ï¼Œå•ä½æ˜¯`hz(èµ«å…¹)`ã€‚

- [FPS](https://developer.chrome.com/docs/devtools/evaluate-performance/?utm_source=devtools#analyze_frames_per_second)å…¨ç§°ä¸º**Frams Per Second**ï¼Œå³**æ¯ç§’çš„å¸§æ•°**ï¼Œä¹Ÿå°±æ˜¯**æ¸²æŸ“æµæ°´çº¿æ¯ç§’æ›´æ–°çš„å¸§æ•°**ã€‚ç½‘é¡µä¸Šæˆ‘ä»¬çœ‹åˆ°çš„å„ç§å„æ ·çš„æ•ˆæœï¼Œéƒ½æ˜¯ä¸€ä¸ªå¸§ä¸€ä¸ªå¸§æ¸²æŸ“å‡ºæ¥çš„ã€‚å¯ä»¥å°†ä¸€ä¸ªå¸§ç†è§£æˆä¸€ä¸ªç”»é¢ï¼ŒFPSå°±æ˜¯æ¯ç§’ç”»é¢æ›´æ–°çš„æ¬¡æ•°ã€‚å¦‚æœå’±ä»¬é¡µé¢ä¸Šæœ‰åŠ¨ç”»ï¼ŒFPSè¶Šå¤§ï¼ŒåŠ¨ç”»å°±è¶Šæµç•…ã€‚è¿™é‡Œæ‘˜æŠ„[ä¸€ä½å¤§ä½¬](https://zhuanlan.zhihu.com/p/78569750)çš„æ•°æ®ï¼š  
  - FPSèƒ½å¤Ÿè¾¾åˆ°`50 ï½ 60`çš„åŠ¨ç”»å°†ä¼šç›¸å½“æµç•…ï¼Œè®©äººå€æ„Ÿèˆ’é€‚ï¼›
  - FPSåœ¨`30 ï½ 50`ä¹‹é—´çš„åŠ¨ç”»ï¼Œå› å„äººæ•æ„Ÿç¨‹åº¦ä¸åŒï¼Œèˆ’é€‚åº¦å› äººè€Œå¼‚ï¼›
  - FPSåœ¨`30`ä»¥ä¸‹çš„åŠ¨ç”»ï¼Œè®©äººæ„Ÿè§‰åˆ°æ˜æ˜¾çš„å¡é¡¿å’Œä¸é€‚æ„Ÿï¼›
  - FPSæ³¢åŠ¨å¾ˆå¤§çš„åŠ¨ç”»ï¼Œäº¦ä¼šä½¿äººæ„Ÿè§‰åˆ°å¡é¡¿ã€‚
- æµè§ˆå™¨çš„FPSå—é™äºè®¾å¤‡çš„å±å¹•åˆ·æ–°ç‡ï¼Œå³**FPSçš„å€¼å°äºç­‰äºè®¾å¤‡åˆ·æ–°ç‡çš„å€¼**ï¼›
- ä¸€èˆ¬æµè§ˆå™¨çš„FPSä¸º60ï¼ˆå› ä¸ºå¤§å¤šæ•°è®¾å¤‡çš„å±å¹•åˆ·æ–°ç‡æ˜¯60hzï¼‰ï¼Œä¸”æµè§ˆå™¨çš„FPSä¸æ˜¯æ’å®šçš„ï¼ˆä»ä¸Šè¾¹çš„Performanceå›¾å°±å¯ä»¥çœ‹å‡ºï¼‰ã€‚

## ä¸€å¸§é‡Œå‘ç”Ÿäº†ä»€ä¹ˆ

![æµè§ˆå™¨çš„ä¸€å¸§](https://gitee.com/ahuang6027/blog-images/raw/master/images/process-one-frame.png)

ã€â—æ³¨æ„ã€‘  

- æµè§ˆå™¨æ— éœ€æ‰§è¡Œæ‰€æœ‰è¿™äº›æ­¥éª¤ï¼Œå…·ä½“å–å†³äºæ‰€éœ€çš„æ­¥éª¤ã€‚æ¯”å¦‚ï¼Œå¦‚æœæ²¡æœ‰è¦è§£æçš„æ–°HTMLï¼Œåˆ™ä¸ä¼šè§¦å‘Parse HTMLï¼ˆè¿™ä¸€ç‚¹ä¼šæ”¾åœ¨åè¾¹è®²ï¼‰ï¼›
- `Recalc Styles`å’Œ`Layout`ä¸‹çš„çº¢è‰²ç®­å¤´ï¼Œå®ƒä»¬ä¼¼ä¹æ˜¯æŒ‡å‘äº†`requestAnimationFrame`

### Vsync and input data

`Vsync and input data`å¯ä»¥ç†è§£æˆ**è¾“å…¥äº‹ä»¶**ã€‚ä»æµè§ˆå™¨çš„è§’åº¦æ¥çœ‹ï¼Œè¾“å…¥å…¶å®ä»£è¡¨ç€æ¥è‡ªç”¨æˆ·çš„**ä»»ä½•æ‰‹åŠ¿åŠ¨ä½œ(gesture)**ï¼ŒåŒ…æ‹¬æ»šåŠ¨é¡µé¢ã€è§¦ç¢°å±å¹•ã€ç§»åŠ¨é¼ æ ‡ã€ç‚¹å‡»é¡µé¢ç­‰ç­‰ã€‚

#### å…·ä½“æ­¥éª¤

1. ç”¨æˆ·åšäº†æ‰‹åŠ¿åŠ¨ä½œï¼ˆæ¯”å¦‚ç§»åŠ¨é¼ æ ‡ï¼‰ï¼Œ`Browserè¿›ç¨‹`æ¥æ”¶åˆ°è¿™ä¸ªäº‹ä»¶ï¼›
   1. ã€â—Tipã€‘`Browserè¿›ç¨‹`æ˜¯ç¬¬ä¸€ä¸ªæ¥æ”¶åˆ°è¿™äº›äº‹ä»¶çš„åœ°æ–¹ã€‚
2. `Browserè¿›ç¨‹`å°†äº‹ä»¶çš„**ç±»å‹(å¦‚touchstart)å’Œåæ ‡(coordinates)**å‘é€ç»™`Rendererè¿›ç¨‹`ï¼š`Browserè¿›ç¨‹`åªèƒ½çŸ¥é“ç”¨æˆ·çš„æ‰‹åŠ¿åŠ¨ä½œå‘ç”Ÿåœ¨ä»€ä¹ˆåœ°æ–¹ï¼Œè€Œä¸çŸ¥é“å¦‚ä½•å¤„ç†ï¼ˆå› ä¸ºtabé¡µå†…çš„å†…å®¹æ˜¯ç”±é¡µé¢çš„`Rendererè¿›ç¨‹`è´Ÿè´£çš„ï¼‰ï¼Œæ‰€ä»¥`Browserè¿›ç¨‹`ä¼šå°†äº‹ä»¶çš„ç›¸å…³ä¿¡æ¯å‘ç»™`Rendererè¿›ç¨‹`çš„`åˆæˆ(Compositor)çº¿ç¨‹`ï¼›

### Frame start

åœ¨äº†è§£å…·ä½“æ­¥éª¤ä¹‹å‰ï¼Œå…ˆæ¥çœ‹ä¸€ä¸ªæ¦‚å¿µğŸ‘‡

#### éå¿«é€Ÿæ»šåŠ¨åŒºåŸŸ - non-fast scrollable region

é¡µé¢çš„JSè„šæœ¬æ˜¯åœ¨`ä¸»çº¿ç¨‹`ä¸­è¿è¡Œçš„ï¼Œæ‰€ä»¥ä¸€ä¸ªé¡µé¢è¢«åˆæˆæ—¶ï¼Œ`åˆæˆçº¿ç¨‹`ä¼šå°†é¡µé¢ä¸Šæ³¨å†Œäº†äº‹ä»¶ç›‘å¬å™¨çš„åŒºåŸŸæ ‡è®°ä¸ºâ€œéå¿«é€Ÿæ»šåŠ¨åŒºåŸŸâ€ã€‚

è¿™æ ·ä¸€æ¥ï¼š

- ç”¨æˆ·äº‹ä»¶**å‘ç”Ÿ**åœ¨éå¿«é€Ÿæ»šåŠ¨åŒºåŸŸæ—¶ï¼š`åˆæˆçº¿ç¨‹`å°±èƒ½çŸ¥é“æœ‰äº‹ä»¶ç›‘å¬å™¨éœ€è¦`ä¸»çº¿ç¨‹`æ¥å¤„ç†ï¼Œä¼šå°†è¾“å…¥äº‹ä»¶å‘é€ç»™`ä¸»çº¿ç¨‹`ï¼›
- è¾“å…¥äº‹ä»¶**æ²¡å‘ç”Ÿ**åœ¨éå¿«é€Ÿæ»šåŠ¨åŒºåŸŸæ—¶ï¼š`åˆæˆçº¿ç¨‹`å°±ä¸éœ€è¦ä¸»çº¿ç¨‹çš„å‚ä¸ï¼Œç›´æ¥åˆæˆä¸€ä¸ªæ–°çš„å¸§ã€‚

![éå¿«é€Ÿæ»šåŠ¨åŒºåŸŸæœ‰ç”¨æˆ·äº‹ä»¶å‘ç”Ÿæ—¶çš„ç¤ºæ„å›¾](https://gitee.com/ahuang6027/blog-images/raw/master/images/process-frame-not-fast-region.png)

##### å»¶ç”³: JSäº‹ä»¶å§”æ‰˜ä¸ä¸€å®šå®æƒ 

å¼€å‘å½“ä¸­å¸¸è§çš„ä¸€ä¸ªäº‹ä»¶ç»‘å®šçš„æ–¹å¼-äº‹ä»¶å§”æ‰˜(event delegation)ï¼šåˆ©ç”¨äº‹ä»¶ä¼šå†’æ³¡è¿™ä¸€ç‰¹æ€§ï¼Œé€šè¿‡ç»™é¡¶å±‚å…ƒç´ ç»‘å®šäº‹ä»¶ç›‘å¬å‡½æ•°æ¥ä½œä¸ºå…¶æ‰€æœ‰å­å…ƒç´ çš„äº‹ä»¶å§”æ‰˜è€…ï¼Œè¿™æ ·å­èŠ‚ç‚¹çš„äº‹ä»¶å°±å¯ä»¥ç»Ÿä¸€è¢«é¡¶å±‚çˆ¶å…ƒç´ å¤„ç†äº†ã€‚ç±»ä¼¼äºè¿™æ ·çš„ï¼š

```js
  document.body.addEventListener('touchstart', event => {
  if (event.target === area) {
    event.preventDefault()
  }
})
```

åœ¨äº†è§£äº†â€œéå¿«é€Ÿæ»šåŠ¨åŒºåŸŸâ€åï¼Œæˆ‘ä»¬æ¥åˆ†æä»¥ä¸‹ä¸Šè¾¹çš„ä»£ç ï¼š

- ç»™bodyå…ƒç´ ç»‘å®šäº†äº‹ä»¶ç›‘å¬å™¨åå…¶å®æ˜¯å°†æ•´ä¸ªé¡µé¢éƒ½æ ‡è®°ä¸ºä¸€ä¸ªéå¿«é€Ÿæ»šåŠ¨åŒºåŸŸï¼›
- å½“ä¸æ˜¯äº‹ä»¶çš„ç›®æ ‡å­å…ƒç´ è§¦å‘äº‹ä»¶ï¼Œåˆæˆçº¿ç¨‹ä¹Ÿä¼šå‘ŠçŸ¥ä¸»çº¿ç¨‹å¹¶ä¸”ä¼šç­‰å¾…ä¸»çº¿ç¨‹å¤„ç†å®Œå®ƒæ‰å¹²æ´»ï¼›
- å› æ­¤è¿™ç§æƒ…å†µä¸‹åˆæˆçº¿ç¨‹å°±ä¸§å¤±æä¾›æµç•…ç”¨æˆ·ä½“éªŒçš„èƒ½åŠ›äº†ï¼ˆsmooth scrolling abilityï¼‰ã€‚

**å¦‚ä½•è§£å†³**ï¼š  

ä¸ºäº†å‡è½»è¿™ç§æƒ…å†µçš„å‘ç”Ÿï¼Œå¯ä»¥ä¸ºäº‹ä»¶ç›‘å¬å™¨ä¼ é€’`passiveï¼štrue`é€‰é¡¹ï¼šå®ƒä¼šå‘Šè¯‰æµè§ˆå™¨ä»è¦åœ¨`ä¸»çº¿ç¨‹`ä¸­ä¾¦å¬äº‹ä»¶ï¼Œå¯æ˜¯`åˆæˆçº¿ç¨‹`ä¹Ÿå¯ä»¥ç»§ç»­åˆæˆæ–°çš„å¸§ã€‚

```js
document.body.addEventListener('touchstart', event => {
    if (event.target === area) {
        event.preventDefault()
    }
 }, {passive: true});
```

#### å‘½ä¸­æµ‹è¯•(Hit Test)

å‘½ä¸­æµ‹è¯•æ˜¯`ä¸»çº¿ç¨‹`éå†åœ¨æ¸²æŸ“æµæ°´çº¿ä¸­ç”Ÿæˆçš„ç»˜ç”»è®°å½•(paint records)æ¥æ‰¾åˆ°è¾“å…¥äº‹ä»¶å‡ºç°çš„`x`, `y`åæ ‡ä¸Šé¢æç»˜çš„å¯¹è±¡æ˜¯å“ªä¸ª(å³`target`)ã€‚  
![ä¸»çº¿ç¨‹é€šè¿‡éå†ç»˜ç”»è®°å½•æ¥ç¡®å®šåœ¨xï¼Œyåæ ‡ä¸Šçš„æ˜¯å“ªä¸ªå¯¹è±¡](https://gitee.com/ahuang6027/blog-images/raw/master/images/process-frame-hit-test.png)

#### å…·ä½“æ­¥éª¤

- `åˆæˆçº¿ç¨‹`æ¥æ”¶åˆ°äº‹ä»¶çš„**ç±»å‹å’Œåæ ‡**åï¼Œä¸€ä¸ªå¸§å°±å¼€å§‹äº†ï¼›
- `åˆæˆçº¿ç¨‹`å¯¹æ¯”åæ ‡æ˜¯å¦åœ¨â€œéå¿«é€Ÿæ»šåŠ¨åŒºåŸŸâ€ï¼Œåˆ¤æ–­è¿™ä¸ªäº‹ä»¶æœ‰æ²¡æœ‰ç”¨æˆ·äº‹ä»¶çš„ç›‘å¬å™¨ã€æ˜¯å¦éœ€è¦è·¯ç”±ç»™ä¸»çº¿ç¨‹å¤„ç†ï¼›ï¼ˆè¿™é‡Œæˆ‘ä»¬å‡è®¾åœ¨â€œéå¿«é€Ÿæ»šåŠ¨åŒºåŸŸâ€ä¸­ï¼Œ`åˆæˆçº¿ç¨‹`å‘`ä¸»çº¿ç¨‹`å‘é€äº‹ä»¶çš„ç›¸å…³ä¿¡æ¯ï¼‰
- `ä¸»çº¿ç¨‹`é€šè¿‡å‘½ä¸­æµ‹è¯•æ‰¾åˆ°äº‹ä»¶çš„ç›®æ ‡å¯¹è±¡(target)

## å‚è€ƒ

- [Inside look at modern web browser (part 4)](https://developer.chrome.com/blog/inside-browser-part4)
- [ä¸€æ–‡çœ‹æ‡‚Chromeæµè§ˆå™¨è¿è¡Œæœºåˆ¶](https://zhuanlan.zhihu.com/p/102149546)
- [Rendering Performance](https://web.dev/rendering-performance/)
- [æµè§ˆå™¨æ¯ä¸€å¸§](https://github.com/hushicai/hushicai.github.io/issues/5)
- [æµè§ˆå™¨æ¸²æŸ“ä¼˜åŒ–](https://github.com/hushicai/hushicai.github.io/issues/3)
- [å‰ç«¯æ€§èƒ½ä¼˜åŒ–--åˆ·æ–°ç‡(FPS)](https://zhuanlan.zhihu.com/p/78569750)
- [èµ°è¿›React Fiberçš„ä¸–ç•Œ](https://juejin.cn/post/6943896410987659277)
