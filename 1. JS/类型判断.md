## 1. ç”¨typeof

### 1.1. å¯¹äºŽåŸºç¡€ç±»åž‹

å¯¹äºŽåŸºæœ¬ç±»åž‹ï¼Œé™¤äº†`null`éƒ½å¯ä»¥æ˜¾ç¤ºæ­£ç¡®çš„ç±»åž‹ã€‚

```js
typeof 1 // 'number'
typeof '1' // 'string'
typeof undefined // 'undefined'
typeof true // 'boolean'
typeof Symbol() // 'symbol'
typeof b // b æ²¡æœ‰å£°æ˜Žï¼Œä½†æ˜¯è¿˜ä¼šæ˜¾ç¤º undefined

typeof null // 'object'
```

#### 1.1.1. ä¸ºä»€ä¹ˆ`typeof null === 'object'`

åœ¨ JS çš„æœ€åˆç‰ˆæœ¬ä¸­ï¼Œä½¿ç”¨çš„æ˜¯32ä½ç³»ç»Ÿï¼Œä¸ºäº†æ€§èƒ½è€ƒè™‘ä½¿ç”¨ä½Žä½å­˜å‚¨äº†å˜é‡çš„ç±»åž‹ä¿¡æ¯ï¼Œ`000`å¼€å¤´ä»£è¡¨æ˜¯å¯¹è±¡ï¼Œç„¶è€Œ`null`è¡¨ç¤ºä¸ºå…¨é›¶ï¼Œæ‰€ä»¥å°†å®ƒ**é”™è¯¯**çš„åˆ¤æ–­ä¸º`object`ã€‚è™½ç„¶çŽ°åœ¨çš„å†…éƒ¨ç±»åž‹åˆ¤æ–­ä»£ç å·²ç»æ”¹å˜äº†ï¼Œä½†æ˜¯å¯¹äºŽè¿™ä¸ªBugå´æ˜¯ä¸€ç›´æµä¼ ä¸‹æ¥ã€‚

### 1.2. å¯¹äºŽå¼•ç”¨ç±»åž‹

å¯¹äºŽå¼•ç”¨ç±»åž‹ï¼Œé™¤äº†**å‡½æ•°**éƒ½ä¼šæ˜¾ç¤º `object`

```js
typeof [] // 'object'
typeof {} // 'object'
typeof console.log // 'function'
```

### 1.3. å°ç»“

`typeof`å¯èƒ½æœ‰ä»¥ä¸‹å–å€¼ðŸ‘‡

```js
// null
typeof null // 'object'

// åŸºç¡€ç±»åž‹
typeof 1 // 'number'
typeof '1' // 'string'
typeof undefined // 'undefined'
typeof true // 'boolean'
typeof Symbol() // 'symbol'
typeof BigInt(1) // 'bigint'

// å¼•ç”¨ç±»åž‹
typeof [] // 'object'
typeof {} // 'object'
typeof console.log // 'function'
```

## 2. ç”¨åŽŸåž‹ - `instanceof`æ–¹æ³•ï¼ˆè¿”å›žBooleanå€¼ï¼‰

`instanceof()`æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œè¿”å›žå€¼ä¸º`true | false`ã€‚

### 2.1. å¯¹äºŽå¼•ç”¨ç±»åž‹

```js
const Person = function() {}
const p1 = new Person()
p1 instanceof Person // true

var str = 'hello world'
str instanceof String // false

var str1 = new String('hello world')
str1 instanceof String // true
```

### 2.2. å¯¹äºŽåŸºç¡€ç±»åž‹

å¯¹äºŽåŸºç¡€ç±»åž‹æ¥è¯´ï¼Œæƒ³ç›´æŽ¥é€šè¿‡`instanceof`æ¥åˆ¤æ–­ç±»åž‹æ˜¯ä¸è¡Œçš„ï¼Œå½“ç„¶æˆ‘ä»¬è¿˜æ˜¯æœ‰åŠžæ³•è®©`instanceof`åˆ¤æ–­åŽŸå§‹ç±»åž‹çš„ï¼š

```js
class PrimitiveString {
  static [Symbol.hasInstance]() {
    return typeof x === 'string'
  }
}

console.log('hello world' instanceof PrimitiveString) // true
```

ä½ å¯èƒ½ä¸çŸ¥é“`Symbol.hasInstance`æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œå…¶å®žå°±æ˜¯ä¸€ä¸ªèƒ½è®©æˆ‘ä»¬è‡ªå®šä¹‰`instanceof`è¡Œä¸ºçš„ä¸œè¥¿ï¼Œä»¥ä¸Šä»£ç ç­‰åŒäºŽ`typeof 'hello world' === 'string'`ï¼Œæ‰€ä»¥ç»“æžœè‡ªç„¶æ˜¯`true`äº†ã€‚è¿™å…¶å®žä¹Ÿä¾§é¢åæ˜ äº†ä¸€ä¸ªé—®é¢˜ï¼Œ`instanceof`ä¸æ˜¯ç™¾åˆ†ä¹‹ç™¾å¯ä¿¡çš„ã€‚

## 3. ç”¨åŽŸåž‹ - Object.prototype.toString.call()ï¼ˆè¿”å›ž'[Object xxx]'ï¼‰

![](http://rc9frlwp7.hn-bkt.clouddn.com/%E9%9D%A2%E8%AF%95%E9%9B%86%E9%94%A6-%E7%B1%BB%E5%9E%8B%E5%88%A4%E6%96%AD.png#crop=0&crop=0&crop=1&crop=1&id=YxKeu&originHeight=318&originWidth=349&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
![](http://rc9frlwp7.hn-bkt.clouddn.com/20211008212342.png#crop=0&crop=0&crop=1&crop=1&id=fIUW6&originHeight=44&originWidth=252&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

## 4. æ€»ç»“

åˆ¤æ–­ç›®æ ‡å˜é‡çš„ç±»åž‹ï¼Œå•å•ç”¨`typeof`å¹¶æ— æ³•å®Œå…¨æ»¡è¶³ï¼Œè¿™å…¶å®žå¹¶ä¸æ˜¯bugï¼Œæœ¬è´¨åŽŸå› æ˜¯JSçš„ä¸‡ç‰©çš†å¯¹è±¡çš„ç†è®ºã€‚å› æ­¤è¦çœŸæ­£å®Œç¾Žåˆ¤æ–­æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åŒºåˆ†å¯¹å¾…:

- åŸºæœ¬ç±»åž‹(null): ä½¿ç”¨`String(null)`
- åŸºæœ¬ç±»åž‹(string / number / boolean / undefined) + function: ç›´æŽ¥ä½¿ç”¨`typeof`å³å¯
- å…¶ä½™å¼•ç”¨ç±»åž‹(Array / Date / RegExp Error): è°ƒç”¨toStringåŽæ ¹æ®`[object XXX]`è¿›è¡Œåˆ¤æ–­

å¾ˆç¨³çš„åˆ¤æ–­å°è£…:

```js
let class2type = {}
'Array Date RegExp Object Error'.split(' ').forEach(e => class2type[ '[object ' + e + ']' ] = e.toLowerCase()) 

function type(obj) {
    if (obj == null) return String(obj)
    return typeof obj === 'object' ? class2type[ Object.prototype.toString.call(obj) ] || 'object' : typeof obj
}
```
